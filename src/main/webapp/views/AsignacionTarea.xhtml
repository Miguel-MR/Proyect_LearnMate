<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Gestión de Tareas</title>
    <h:outputStylesheet name="styles.css"/>
</h:head>
<h:body style="margin: 30px; font-family: 'Segoe UI';">
    <h:form enctype="multipart/form-data">
        <h2>📘 Gestión de Tareas</h2>

        <h:messages globalOnly="true" style="color:red;" />

        <h3>Crear Nueva Tarea</h3>

        <h:panelGrid columns="2" cellpadding="5">

            <h:outputLabel value="Curso:"/>
            <h:selectOneMenu value="#{tareasController.idCursoSeleccionado}">
                <f:selectItem itemLabel="Seleccione un curso" itemValue="#{null}"/>
                <f:selectItems value="#{tareasController.listaCursos}" var="c"
                               itemLabel="#{c.nombre}" itemValue="#{c.idCurso}" />
            </h:selectOneMenu>

            <h:outputLabel value="Asignatura:"/>
            <h:selectOneMenu value="#{tareasController.idAsignacionSeleccionada}">
                <f:selectItem itemLabel="Seleccione una asignatura" itemValue="#{null}"/>
                <f:selectItems value="#{tareasController.listaAsignaciones}" var="a"
                               itemLabel="#{a.asignaturaId.nombre}" itemValue="#{a.idAsignacion}" />
            </h:selectOneMenu>

            <h:outputLabel value="Título:"/>
            <h:inputText value="#{tareasController.tareaNueva.titulo}" required="true"/>

            <h:outputLabel value="Descripción:"/>
            <h:inputTextarea value="#{tareasController.tareaNueva.descripcion}" rows="3"/>

            <h:outputLabel value="Fecha de Entrega:"/>
            <h:inputText value="#{tareasController.tareaNueva.fechaEntrega}">
                <f:convertDateTime pattern="yyyy-MM-dd" />
            </h:inputText>

        </h:panelGrid>

        <h:commandButton value="➕ Crear Tarea"
                         action="#{tareasController.crearTarea}"
                         style="margin-top:10px; background-color:#2196F3; color:white; border:none; padding:8px 15px; border-radius:6px;"/>

        <hr/>

        <h3>📋 Lista de Tareas</h3>
        <h:dataTable value="#{tareasController.listaTareas}" var="t"
                     border="1" style="width:100%; text-align:center; border-collapse:collapse;">
            <h:column>
                <f:facet name="header">ID</f:facet>
                #{t.idTarea}
            </h:column>
            <h:column>
                <f:facet name="header">Título</f:facet>
                #{t.titulo}
            </h:column>
            <h:column>
                <f:facet name="header">Asignatura</f:facet>
                #{t.asignacionId.asignaturaId.nombre}
            </h:column>
            <h:column>
                <f:facet name="header">Fecha de Entrega</f:facet>
                <h:outputText value="#{t.fechaEntrega}">
                    <f:convertDateTime pattern="yyyy-MM-dd" />
                </h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Acciones</f:facet>
                <h:commandButton value="🗑️ Eliminar"
                                 action="#{tareasController.eliminarTarea(t)}"
                                 style="background-color:#e53935; color:white; border:none; padding:4px 10px; border-radius:5px;"/>
            </h:column>
        </h:dataTable>
    </h:form>
</h:body>
</html>
